iscoToEGPibge <-

function(dados,            # Character. Nome do data.frame
         
         var_isco,         # Character Nome da variável sobre a ocupação do individuo, já 
                           # convertida para o sistema ISCO-88
         
         var_isic,         # Character Nome da variável setor de atividade da ocupação do 
                           # indivíduo, no sistema ISIC-3
         
         var_posOcup,      # Character. Nome da variável sobre posição na ocupação - padronizada
         
         
         var_renda.trab,   # Character. para o Censo de 1960, a variável renda do trabalho é categorica. 
                           # Assumimos que o valor "98" indique o grupo dos "sem rendimentos"
                           # Para os demais anos e bancos de dados, assume-se que a variável 
                           # renda do trabalho é contínua e que os sem rendimento tenham sejam
                           # indicados pelo valor Zero. 
         
         var_transicoes = NULL,      # Character. Nome da variável de transições educacionais.
                                      # Apenas é necessária quando tipo="censo" e ano="2010"
                  
         tipo="censo",      # Character. "censo" ou "pnad"
         
         ano               #numeric se tipo="censo": 1960, 1970, 1980, 1991, 2000, 2010
                           #         se tipo="pnad":  1981:1990, 1992:1993, 1995:1999, 2001:2009, 2011:2013
                           #         se ano = NULL,   todos os anos
         
         ){
  

        # 1970
        #      V044
        
        # 2010
        #      v6461

        
        Verifica_data.table <- require(data.table)
        if(!Verifica_data.table){
                return(
                        message("ERRO: Não foi possivel carregar o pacote data.table.\nTalvez ele não esteja instalado")
                )
        }
        
        
        banco <- data.table(isco = get(dados)[[var_isco]],
                            isic = get(dados)[[var_isic]],
                            PosicaoOcup  = get(dados)[[var_posOcup]],
                            renda.trab  = get(dados)[[var_renda.trab]]#renda.trab.cat.1960                    
                            )

        
        
        
        if(ano == 2010 & tipo == "censo"){
                if(is.null(var_transicoes)){
                        return(message("ERRO: var_transicoes=NULL.\nPara o Censo de 2010, você deve informar o nome da variável de transições educacionais. "))
                }else{               
                banco$trtot <- get(dados)[[var_transicoes]]
                }
        }
        
        # Cria uma indicadora de renda zero
        banco[, rendaZero := 0 ]
        if(ano == 1960 & tipo == "censo"){
                banco[renda.trab == 98, rendaZero := 1]
        }else{
                banco[renda.trab == 0, rendaZero := 1]
        }
        
        
        
        
        
        # Recodificação        
        banco[ , egp11 := double(length=nrow(banco))]
        
        banco[ isco ==  1110, egp11 := 1]
        banco[ isco == 	1120, egp11 := 1]
        banco[ isco == 	1130, egp11 := 1]
        banco[ isco == 	1210, egp11 := 1]
        banco[ isco == 	1222, egp11 := 1]
        banco[ isco == 	1223, egp11 := 1]
        banco[ isco == 	1224, egp11 := 1]
        banco[ isco == 	1225, egp11 := 1]
        banco[ isco == 	1226, egp11 := 1]
        banco[ isco == 	1227, egp11 := 1]
        banco[ isco == 	1228, egp11 := 1]
        banco[ isco == 	1229, egp11 := 1]
        banco[ isco == 	1231, egp11 := 1]
        banco[ isco == 	1232, egp11 := 1]
        banco[ isco == 	1233, egp11 := 1]
        banco[ isco == 	1234, egp11 := 1]
        banco[ isco == 	1235, egp11 := 1]
        banco[ isco == 	1236, egp11 := 1]
        banco[ isco == 	1237, egp11 := 1]
        banco[ isco == 	1239, egp11 := 1]
        banco[ isco == 	2111, egp11 := 1]
        banco[ isco == 	2112, egp11 := 1]
        banco[ isco == 	2113, egp11 := 1]
        banco[ isco == 	2114, egp11 := 1]
        banco[ isco == 	2121, egp11 := 1]
        banco[ isco == 	2122, egp11 := 1]
        banco[ isco == 	2131, egp11 := 1]
        banco[ isco == 	2141, egp11 := 1]
        banco[ isco == 	2142, egp11 := 1]
        banco[ isco == 	2143, egp11 := 1]
        banco[ isco == 	2144, egp11 := 1]
        banco[ isco == 	2145, egp11 := 1]
        banco[ isco == 	2146, egp11 := 1]
        banco[ isco == 	2147, egp11 := 1]
        banco[ isco == 	2148, egp11 := 1]
        banco[ isco == 	2149, egp11 := 1]
        banco[ isco == 	2211, egp11 := 1]
        banco[ isco == 	2212, egp11 := 1]
        banco[ isco == 	2213, egp11 := 1]
        banco[ isco == 	2221, egp11 := 1]
        banco[ isco == 	2222, egp11 := 1]
        banco[ isco == 	2223, egp11 := 1]
        banco[ isco == 	2224, egp11 := 1]
        banco[ isco == 	2229, egp11 := 1]
        banco[ isco == 	2310, egp11 := 1]
        banco[ isco == 	2351, egp11 := 1]
        banco[ isco == 	2352, egp11 := 2]
        banco[ isco == 	2411, egp11 := 1]
        banco[ isco == 	2421, egp11 := 1]
        banco[ isco == 	2422, egp11 := 1]
        banco[ isco == 	2429, egp11 := 1]
        banco[ isco == 	2441, egp11 := 1]
        banco[ isco == 	2442, egp11 := 1]
        banco[ isco == 	2443, egp11 := 1]
        banco[ isco == 	2445, egp11 := 1]
        banco[ isco == 	3143, egp11 := 1]
        banco[ isco == 	3144, egp11 := 2]
        banco[ isco == 	2452, egp11 := 2]
        banco[ isco == 	5151, egp11 := 2]
        banco[ isco == 	2453, egp11 := 2]
        banco[ isco == 	2460, egp11 := 2]
        banco[ isco == 	3232, egp11 := 2]
        banco[ isco == 	1143, egp11 := 2]
        banco[ isco == 	3472, egp11 := 2]
        banco[ isco == 	3471, egp11 := 2]
        banco[ isco == 	3417, egp11 := 2]
        banco[ isco == 	3413, egp11 := 2]
        banco[ isco == 	3415, egp11 := 2]
        banco[ isco == 	3225, egp11 := 2]
        banco[ isco == 	2431, egp11 := 2]
        banco[ isco == 	3231, egp11 := 2]
        banco[ isco == 	2455, egp11 := 2]
        banco[ isco == 	3224, egp11 := 2]
        banco[ isco == 	3416, egp11 := 2]
        banco[ isco == 	2359, egp11 := 3]
        banco[ isco == 	3475, egp11 := 2]
        banco[ isco == 	3431, egp11 := 2]
        banco[ isco == 	3411, egp11 := 2]
        banco[ isco == 	3122, egp11 := 2]
        banco[ isco == 	2419, egp11 := 2]
        banco[ isco == 	3450, egp11 := 2]
        banco[ isco == 	3434, egp11 := 2]
        banco[ isco == 	2332, egp11 := 3]
        banco[ isco == 	2446, egp11 := 2]
        banco[ isco == 	3449, egp11 := 2]
        banco[ isco == 	2331, egp11 := 3]
        banco[ isco == 	3432, egp11 := 2]
        banco[ isco == 	2444, egp11 := 2]
        banco[ isco == 	3422, egp11 := 2]
        banco[ isco == 	3228, egp11 := 2]
        banco[ isco == 	2451, egp11 := 2]
        banco[ isco == 	3423, egp11 := 2]
        banco[ isco == 	3227, egp11 := 2]
        banco[ isco == 	3226, egp11 := 2]
        banco[ isco == 	2230, egp11 := 2]
        banco[ isco == 	2320, egp11 := 2]
        banco[ isco == 	1141, egp11 := 2]
        banco[ isco == 	1142, egp11 := 2]
        banco[ isco == 	1312, egp11 := 2]
        banco[ isco == 	1313, egp11 := 2]
        banco[ isco == 	1314, egp11 := 2]
        banco[ isco == 	1315, egp11 := 2]
        banco[ isco == 	1316, egp11 := 2]
        banco[ isco == 	1317, egp11 := 2]
        banco[ isco == 	1318, egp11 := 2]
        banco[ isco == 	1319, egp11 := 2]
        banco[ isco == 	2132, egp11 := 2]
        banco[ isco == 	2139, egp11 := 2]
        banco[ isco == 	2340, egp11 := 2]
        banco[ isco == 	2412, egp11 := 2]
        banco[ isco == 	2454, egp11 := 2]
        banco[ isco == 	3121, egp11 := 2]
        banco[ isco == 	3221, egp11 := 2]
        banco[ isco == 	3222, egp11 := 2]
        banco[ isco == 	3223, egp11 := 2]
        banco[ isco == 	3229, egp11 := 2]
        banco[ isco == 	3241, egp11 := 2]
        banco[ isco == 	3242, egp11 := 2]
        banco[ isco == 	3310, egp11 := 2]
        banco[ isco == 	3320, egp11 := 2]
        banco[ isco == 	3412, egp11 := 2]
        banco[ isco == 	3414, egp11 := 2]
        banco[ isco == 	3419, egp11 := 2]
        banco[ isco == 	3421, egp11 := 2]
        banco[ isco == 	3429, egp11 := 2]
        banco[ isco == 	3441, egp11 := 2]
        banco[ isco == 	3442, egp11 := 2]
        banco[ isco == 	3443, egp11 := 2]
        banco[ isco == 	3444, egp11 := 2]
        banco[ isco == 	3473, egp11 := 2]
        banco[ isco == 	3474, egp11 := 2]
        banco[ isco == 	5152, egp11 := 2]
        banco[ isco == 	2432, egp11 := 3]
        banco[ isco == 	4213, egp11 := 4]
        banco[ isco == 	5112, egp11 := 3]
        banco[ isco == 	4132, egp11 := 3]
        banco[ isco == 	4131, egp11 := 3]
        banco[ isco == 	5113, egp11 := 3]
        banco[ isco == 	4215, egp11 := 3]
        banco[ isco == 	3340, egp11 := 3]
        banco[ isco == 	4133, egp11 := 3]
        banco[ isco == 	5210, egp11 := 3]
        banco[ isco == 	5111, egp11 := 3]
        banco[ isco == 	4141, egp11 := 3]
        banco[ isco == 	4111, egp11 := 3]
        banco[ isco == 	5162, egp11 := 3]
        banco[ isco == 	4115, egp11 := 3]
        banco[ isco == 	4121, egp11 := 3]
        banco[ isco == 	3439, egp11 := 3]
        banco[ isco == 	3433, egp11 := 3]
        banco[ isco == 	4122, egp11 := 3]
        banco[ isco == 	3330, egp11 := 3]
        banco[ isco == 	3460, egp11 := 3]
        banco[ isco == 	3480, egp11 := 3]
        banco[ isco == 	4112, egp11 := 3]
        banco[ isco == 	4113, egp11 := 3]
        banco[ isco == 	4114, egp11 := 3]
        banco[ isco == 	4143, egp11 := 3]
        banco[ isco == 	4144, egp11 := 3]
        banco[ isco == 	4190, egp11 := 3]
        banco[ isco == 	4212, egp11 := 3]
        banco[ isco == 	4214, egp11 := 3]
        banco[ isco == 	4221, egp11 := 3]
        banco[ isco == 	5161, egp11 := 3]
        banco[ isco == 	5149, egp11 := 4]
        banco[ isco == 	9152, egp11 := 4]
        banco[ isco == 	5123, egp11 := 4]
        banco[ isco == 	9113, egp11 := 4]
        banco[ isco == 	9151, egp11 := 4]
        banco[ isco == 	5220, egp11 := 4]
        banco[ isco == 	4211, egp11 := 4]
        banco[ isco == 	5139, egp11 := 4]
        banco[ isco == 	4142, egp11 := 4]
        banco[ isco == 	4222, egp11 := 4]
        banco[ isco == 	4223, egp11 := 4]
        banco[ isco == 	5132, egp11 := 4]
        banco[ isco == 	5142, egp11 := 4]
        banco[ isco == 	7111, egp11 := 10]
        banco[ isco == 	5143, egp11 := 8]
        banco[ isco == 	3142, egp11 := 8]
        banco[ isco == 	7216, egp11 := 8]
        banco[ isco == 	7242, egp11 := 8]
        banco[ isco == 	7313, egp11 := 8]
        banco[ isco == 	7243, egp11 := 8]
        banco[ isco == 	7312, egp11 := 8]
        banco[ isco == 	7233, egp11 := 8]
        banco[ isco == 	7311, egp11 := 8]
        banco[ isco == 	3115, egp11 := 8]
        banco[ isco == 	3113, egp11 := 8]
        banco[ isco == 	3131, egp11 := 8]
        banco[ isco == 	7245, egp11 := 8]
        banco[ isco == 	3117, egp11 := 8]
        banco[ isco == 	7241, egp11 := 8]
        banco[ isco == 	7222, egp11 := 8]
        banco[ isco == 	7344, egp11 := 8]
        banco[ isco == 	3112, egp11 := 8]
        banco[ isco == 	7343, egp11 := 8]
        banco[ isco == 	3114, egp11 := 8]
        banco[ isco == 	3211, egp11 := 8]
        banco[ isco == 	3132, egp11 := 8]
        banco[ isco == 	3152, egp11 := 8]
        banco[ isco == 	3116, egp11 := 8]
        banco[ isco == 	3111, egp11 := 8]
        banco[ isco == 	8151, egp11 := 8]
        banco[ isco == 	3118, egp11 := 8]
        banco[ isco == 	7232, egp11 := 8]
        banco[ isco == 	3212, egp11 := 8]
        banco[ isco == 	8311, egp11 := 8]
        banco[ isco == 	3133, egp11 := 8]
        banco[ isco == 	3119, egp11 := 8]
        banco[ isco == 	8159, egp11 := 8]
        banco[ isco == 	3123, egp11 := 8]
        banco[ isco == 	3139, egp11 := 8]
        banco[ isco == 	3141, egp11 := 8]
        banco[ isco == 	3145, egp11 := 8]
        banco[ isco == 	3151, egp11 := 8]
        banco[ isco == 	3213, egp11 := 8]
        banco[ isco == 	1221, egp11 := 9]
        banco[ isco == 	1311, egp11 := 9]
        banco[ isco == 	8273, egp11 := 10]
        banco[ isco == 	7424, egp11 := 9]
        banco[ isco == 	7132, egp11 := 9]
        banco[ isco == 	7321, egp11 := 9]
        banco[ isco == 	8276, egp11 := 9]
        banco[ isco == 	8112, egp11 := 9]
        banco[ isco == 	7124, egp11 := 9]
        banco[ isco == 	7122, egp11 := 9]
        banco[ isco == 	8141, egp11 := 9]
        banco[ isco == 	8340, egp11 := 9]
        
        # mestre de obras:
        banco[ isco == 	7129, egp11 := 8] 
        
        banco[ isco == 	7123, egp11 := 9]
        banco[ isco == 	8277, egp11 := 9]
        banco[ isco == 	8332, egp11 := 9]
        banco[ isco == 	7416, egp11 := 9]
        banco[ isco == 	7432, egp11 := 9]
        banco[ isco == 	8212, egp11 := 9]
        banco[ isco == 	8278, egp11 := 9]
        banco[ isco == 	8111, egp11 := 9]
        banco[ isco == 	8271, egp11 := 9]
        banco[ isco == 	7136, egp11 := 9]
        banco[ isco == 	7113, egp11 := 9]
        banco[ isco == 	5122, egp11 := 9]
        banco[ isco == 	7141, egp11 := 9]
        banco[ isco == 	7423, egp11 := 9]
        banco[ isco == 	7214, egp11 := 9]
        banco[ isco == 	8324, egp11 := 9]
        banco[ isco == 	7441, egp11 := 9]
        banco[ isco == 	7133, egp11 := 9]
        banco[ isco == 	7411, egp11 := 9]
        banco[ isco == 	7436, egp11 := 9]
        banco[ isco == 	7422, egp11 := 9]
        banco[ isco == 	8142, egp11 := 9]
        banco[ isco == 	7431, egp11 := 9]
        banco[ isco == 	8162, egp11 := 9]
        banco[ isco == 	7412, egp11 := 9]
        banco[ isco == 	8139, egp11 := 9]
        banco[ isco == 	7435, egp11 := 9]
        banco[ isco == 	7442, egp11 := 9]
        banco[ isco == 	8262, egp11 := 9]
        banco[ isco == 	8153, egp11 := 9]
        banco[ isco == 	7231, egp11 := 9]
        banco[ isco == 	8272, egp11 := 9]
        banco[ isco == 	7213, egp11 := 9]
        banco[ isco == 	8121, egp11 := 9]
        banco[ isco == 	7134, egp11 := 9]
        banco[ isco == 	8231, egp11 := 9]
        banco[ isco == 	8333, egp11 := 9]
        banco[ isco == 	8222, egp11 := 9]
        banco[ isco == 	7135, egp11 := 9]
        banco[ isco == 	8266, egp11 := 9]
        banco[ isco == 	8223, egp11 := 9]
        banco[ isco == 	8124, egp11 := 9]
        banco[ isco == 	8322, egp11 := 9]
        banco[ isco == 	7212, egp11 := 9]
        banco[ isco == 	7421, egp11 := 9]
        banco[ isco == 	7224, egp11 := 9]
        banco[ isco == 	7137, egp11 := 9]
        banco[ isco == 	8261, egp11 := 9]
        banco[ isco == 	8122, egp11 := 9]
        banco[ isco == 	8163, egp11 := 9]
        banco[ isco == 	7211, egp11 := 9]
        banco[ isco == 	7221, egp11 := 9]
        banco[ isco == 	7345, egp11 := 9]
        banco[ isco == 	8269, egp11 := 9]
        banco[ isco == 	8152, egp11 := 9]
        banco[ isco == 	7215, egp11 := 9]
        banco[ isco == 	5141, egp11 := 9]
        banco[ isco == 	8232, egp11 := 9]
        banco[ isco == 	7322, egp11 := 9]
        banco[ isco == 	8281, egp11 := 9]
        banco[ isco == 	8264, egp11 := 9]
        banco[ isco == 	7324, egp11 := 9]
        banco[ isco == 	7131, egp11 := 9]
        banco[ isco == 	8143, egp11 := 9]
        banco[ isco == 	7341, egp11 := 9]
        banco[ isco == 	8312, egp11 := 9]
        banco[ isco == 	8113, egp11 := 9]
        banco[ isco == 	8161, egp11 := 9]
        banco[ isco == 	8253, egp11 := 9]
        banco[ isco == 	5163, egp11 := 9]
        banco[ isco == 	8251, egp11 := 9]
        banco[ isco == 	7332, egp11 := 9]
        banco[ isco == 	8240, egp11 := 9]
        banco[ isco == 	7223, egp11 := 9]
        banco[ isco == 	7433, egp11 := 9]
        banco[ isco == 	8252, egp11 := 9]
        banco[ isco == 	8283, egp11 := 9]
        banco[ isco == 	5169, egp11 := 9]
        banco[ isco == 	7415, egp11 := 9]
        banco[ isco == 	7244, egp11 := 9]
        banco[ isco == 	8221, egp11 := 9]
        banco[ isco == 	8290, egp11 := 9]
        banco[ isco == 	8155, egp11 := 8]
        banco[ isco == 	8172, egp11 := 9]
        banco[ isco == 	8154, egp11 := 8]
        banco[ isco == 	7112, egp11 := 9]
        banco[ isco == 	7121, egp11 := 9]
        banco[ isco == 	7142, egp11 := 9]
        banco[ isco == 	7143, egp11 := 9]
        banco[ isco == 	7323, egp11 := 9]
        banco[ isco == 	7331, egp11 := 9]
        banco[ isco == 	7342, egp11 := 9]
        banco[ isco == 	7346, egp11 := 9]
        banco[ isco == 	7413, egp11 := 9]
        banco[ isco == 	7414, egp11 := 9]
        banco[ isco == 	7434, egp11 := 9]
        banco[ isco == 	7437, egp11 := 9]
        banco[ isco == 	8123, egp11 := 9]
        banco[ isco == 	8131, egp11 := 9]
        banco[ isco == 	8171, egp11 := 9]
        banco[ isco == 	8211, egp11 := 9]
        banco[ isco == 	8224, egp11 := 9]
        banco[ isco == 	8229, egp11 := 9]
        banco[ isco == 	8263, egp11 := 9]
        banco[ isco == 	8265, egp11 := 9]
        banco[ isco == 	8274, egp11 := 9]
        banco[ isco == 	8275, egp11 := 9]
        banco[ isco == 	8279, egp11 := 9]
        banco[ isco == 	8282, egp11 := 9]
        banco[ isco == 	8284, egp11 := 9]
        banco[ isco == 	8285, egp11 := 9]
        banco[ isco == 	8286, egp11 := 9]
        banco[ isco == 	8321, egp11 := 9]
        banco[ isco == 	8323, egp11 := 9]
        banco[ isco == 	8334, egp11 := 9]
        banco[ isco == 	9153, egp11 := 9]
        banco[ isco == 	9313, egp11 := 9]
        banco[ isco == 	9120, egp11 := 10]
        banco[ isco == 	9162, egp11 := 10]
        banco[ isco == 	9311, egp11 := 10]
        banco[ isco == 	9312, egp11 := 10]
        banco[ isco == 	9321, egp11 := 10]
        banco[ isco == 	5121, egp11 := 10]
        banco[ isco == 	5131, egp11 := 10]
        banco[ isco == 	5133, egp11 := 10]
        banco[ isco == 	5230, egp11 := 10]
        banco[ isco == 	9111, egp11 := 10]
        banco[ isco == 	9112, egp11 := 10]
        banco[ isco == 	9131, egp11 := 10]
        banco[ isco == 	9132, egp11 := 10]
        banco[ isco == 	9133, egp11 := 10]
        banco[ isco == 	9141, egp11 := 10]
        banco[ isco == 	9142, egp11 := 10]
        banco[ isco == 	9161, egp11 := 10]
        banco[ isco == 	9322, egp11 := 10]
        banco[ isco == 	9331, egp11 := 10]
        banco[ isco == 	9332, egp11 := 10]
        banco[ isco == 	9333, egp11 := 10]
        banco[ isco == 	6111, egp11 := 11]
        banco[ isco == 	6112, egp11 := 11]
        banco[ isco == 	6113, egp11 := 11]
        banco[ isco == 	6114, egp11 := 11]
        banco[ isco == 	6121, egp11 := 11]
        banco[ isco == 	6122, egp11 := 11]
        banco[ isco == 	6123, egp11 := 11]
        banco[ isco == 	6124, egp11 := 11]
        banco[ isco == 	6129, egp11 := 11]
        banco[ isco == 	6130, egp11 := 11]
        banco[ isco == 	6141, egp11 := 11]
        banco[ isco == 	6142, egp11 := 11]
        banco[ isco == 	6151, egp11 := 11]
        banco[ isco == 	6152, egp11 := 11]
        banco[ isco == 	6153, egp11 := 11]
        banco[ isco == 	6154, egp11 := 11]
        banco[ isco == 	6210, egp11 := 11]
        banco[ isco == 	8331, egp11 := 11]
        banco[ isco == 	9211, egp11 := 11]
        banco[ isco == 	9212, egp11 := 11]
        banco[ isco == 	9213, egp11 := 11]
        banco[ isco == 	1000, egp11 := 1]
        banco[ isco == 	1100, egp11 := 1]
        banco[ isco == 	1200, egp11 := 1]
        banco[ isco == 	1220, egp11 := 1]
        banco[ isco == 	1230, egp11 := 1]
        banco[ isco == 	1250, egp11 := 1]
        banco[ isco == 	1251, egp11 := 1]
        banco[ isco == 	2000, egp11 := 1]
        banco[ isco == 	2100, egp11 := 1]
        banco[ isco == 	2110, egp11 := 1]
        banco[ isco == 	2120, egp11 := 1]
        banco[ isco == 	2130, egp11 := 1]
        banco[ isco == 	2140, egp11 := 1]
        banco[ isco == 	2200, egp11 := 1]
        banco[ isco == 	2210, egp11 := 1]
        banco[ isco == 	2220, egp11 := 1]
        banco[ isco == 	2350, egp11 := 1]
        banco[ isco == 	2400, egp11 := 1]
        banco[ isco == 	2420, egp11 := 1]
        banco[ isco == 	2440, egp11 := 1]
        banco[ isco == 	1140, egp11 := 2]
        banco[ isco == 	1240, egp11 := 2]
        banco[ isco == 	1252, egp11 := 2]
        banco[ isco == 	1300, egp11 := 2]
        banco[ isco == 	1310, egp11 := 2]
        banco[ isco == 	2300, egp11 := 2]
        banco[ isco == 	2321, egp11 := 2]
        banco[ isco == 	2322, egp11 := 2]
        banco[ isco == 	2323, egp11 := 2]
        banco[ isco == 	2330, egp11 := 2]
        banco[ isco == 	2410, egp11 := 2]
        banco[ isco == 	2430, egp11 := 2]
        banco[ isco == 	2450, egp11 := 2]
        banco[ isco == 	3000, egp11 := 2]
        banco[ isco == 	3100, egp11 := 2]
        banco[ isco == 	3110, egp11 := 2]
        banco[ isco == 	3120, egp11 := 2]
        banco[ isco == 	3130, egp11 := 2]
        banco[ isco == 	3140, egp11 := 2]
        banco[ isco == 	3150, egp11 := 2]
        banco[ isco == 	3200, egp11 := 2]
        banco[ isco == 	3210, egp11 := 2]
        banco[ isco == 	3220, egp11 := 2]
        banco[ isco == 	3240, egp11 := 2]
        banco[ isco == 	3400, egp11 := 2]
        banco[ isco == 	3410, egp11 := 2]
        banco[ isco == 	3420, egp11 := 2]
        banco[ isco == 	3440, egp11 := 2]
        banco[ isco == 	3451, egp11 := 2]
        banco[ isco == 	3470, egp11 := 2]
        banco[ isco == 	5150, egp11 := 2]
        banco[ isco == 	3230, egp11 := 3]
        banco[ isco == 	3300, egp11 := 3]
        banco[ isco == 	3430, egp11 := 3]
        banco[ isco == 	4000, egp11 := 3]
        banco[ isco == 	4100, egp11 := 3]
        banco[ isco == 	4110, egp11 := 3]
        banco[ isco == 	4120, egp11 := 3]
        banco[ isco == 	4130, egp11 := 3]
        banco[ isco == 	4140, egp11 := 3]
        banco[ isco == 	4200, egp11 := 3]
        banco[ isco == 	4210, egp11 := 3]
        banco[ isco == 	4220, egp11 := 3]
        banco[ isco == 	5000, egp11 := 3]
        banco[ isco == 	5100, egp11 := 3]
        banco[ isco == 	5110, egp11 := 3]
        banco[ isco == 	5120, egp11 := 3]
        banco[ isco == 	5130, egp11 := 3]
        banco[ isco == 	5200, egp11 := 3]
        banco[ isco == 	9100, egp11 := 3]
        banco[ isco == 	9110, egp11 := 3]
        banco[ isco == 	3452, egp11 := 7]
        banco[ isco == 	7510, egp11 := 7]
        banco[ isco == 	5140, egp11 := 8]
        banco[ isco == 	5164, egp11 := 8]
        banco[ isco == 	7000, egp11 := 8]
        banco[ isco == 	7100, egp11 := 8]
        banco[ isco == 	7110, egp11 := 8]
        banco[ isco == 	7120, egp11 := 8]
        banco[ isco == 	7130, egp11 := 8]
        banco[ isco == 	7140, egp11 := 8]
        banco[ isco == 	7200, egp11 := 8]
        banco[ isco == 	7210, egp11 := 8]
        banco[ isco == 	7220, egp11 := 8]
        banco[ isco == 	7230, egp11 := 8]
        banco[ isco == 	7240, egp11 := 8]
        banco[ isco == 	7300, egp11 := 8]
        banco[ isco == 	7310, egp11 := 8]
        banco[ isco == 	7340, egp11 := 8]
        banco[ isco == 	7400, egp11 := 8]
        banco[ isco == 	7410, egp11 := 8]
        banco[ isco == 	7420, egp11 := 8]
        banco[ isco == 	7430, egp11 := 8]
        banco[ isco == 	7440, egp11 := 8]
        banco[ isco == 	7500, egp11 := 8]
        banco[ isco == 	7520, egp11 := 8]
        banco[ isco == 	8110, egp11 := 8]
        banco[ isco == 	8120, egp11 := 8]
        banco[ isco == 	8150, egp11 := 8]
        banco[ isco == 	8160, egp11 := 8]
        banco[ isco == 	8170, egp11 := 8]
        banco[ isco == 	8210, egp11 := 8]
        banco[ isco == 	5160, egp11 := 9]
        banco[ isco == 	7234, egp11 := 9]
        banco[ isco == 	7320, egp11 := 9]
        banco[ isco == 	7330, egp11 := 9]
        banco[ isco == 	7530, egp11 := 9]
        banco[ isco == 	8000, egp11 := 9]
        banco[ isco == 	8100, egp11 := 9]
        banco[ isco == 	8130, egp11 := 9]
        banco[ isco == 	8140, egp11 := 9]
        banco[ isco == 	8200, egp11 := 9]
        banco[ isco == 	8220, egp11 := 9]
        banco[ isco == 	8230, egp11 := 9]
        banco[ isco == 	8250, egp11 := 9]
        banco[ isco == 	8260, egp11 := 9]
        banco[ isco == 	8270, egp11 := 9]
        banco[ isco == 	8280, egp11 := 9]
        banco[ isco == 	8300, egp11 := 9]
        banco[ isco == 	8310, egp11 := 9]
        banco[ isco == 	8320, egp11 := 9]
        banco[ isco == 	8330, egp11 := 9]
        banco[ isco == 	8400, egp11 := 9]
        banco[ isco == 	9000, egp11 := 9]
        banco[ isco == 	9130, egp11 := 9]
        banco[ isco == 	9140, egp11 := 9]
        banco[ isco == 	9150, egp11 := 9]
        banco[ isco == 	9160, egp11 := 9]
        banco[ isco == 	9300, egp11 := 9]
        banco[ isco == 	9310, egp11 := 9]
        banco[ isco == 	9320, egp11 := 9]
        banco[ isco == 	9330, egp11 := 9]
        banco[ isco == 	6000, egp11 := 10]
        banco[ isco == 	6100, egp11 := 10]
        banco[ isco == 	6110, egp11 := 10]
        banco[ isco == 	6120, egp11 := 10]
        banco[ isco == 	6134, egp11 := 10]
        banco[ isco == 	6140, egp11 := 10]
        banco[ isco == 	6150, egp11 := 10]
        banco[ isco == 	9200, egp11 := 10]
        banco[ isco == 	9210, egp11 := 10]
        banco[ isco == 	6131, egp11 := 11]
        banco[ isco == 	6132, egp11 := 11]
        banco[ isco == 	6133, egp11 := 11]
        banco[ isco == 	6200, egp11 := 11]
        
        # Promove os empregadores (nao rurais).
        banco[ isic != 10 &  isic != 100  & PosicaoOcup == 2, egp11 := 5]
        
        # Promove os empregadores rurais.
        banco[ egp11 == 1  & PosicaoOcup == 2 & isic == 10, egp11 := 6]
        banco[ egp11 == 2  & PosicaoOcup == 2 & isic == 10, egp11 := 6]
        banco[ egp11 == 3  & PosicaoOcup == 2 & isic == 10, egp11 := 6]
        banco[ egp11 == 4  & PosicaoOcup == 2 & isic == 10, egp11 := 6]
        banco[ egp11 == 8  & PosicaoOcup == 2 & isic == 10, egp11 := 6]
        banco[ egp11 == 9  & PosicaoOcup == 2 & isic == 10, egp11 := 6]
        banco[ egp11 == 10 & PosicaoOcup == 2 & isic == 10, egp11 := 6]
        banco[ egp11 == 11 & PosicaoOcup == 2, egp11 := 6]
        
        # Promove os conta-pr?pria rurais.
        banco[ egp11 == 11 & PosicaoOcup == 0, egp11 := 7]
        banco[ egp11 == 11 & PosicaoOcup == 3, egp11 := 7]
        banco[ egp11 == 11 & rendaZero == 1, egp11 := 7]
        
        
        # Ajustes específicos para determinados anos

        if(tipo == "censo" & ano == 1970){
                # v044 é a ocupação principal
                # 15- comerciantes
                banco[ v044 == 15 & (PosicaoOcup == 0 | PosicaoOcup ==3), egp11 := 2]        
        }
        
        
        # para o censo de 2010 (tentativa de categorizar casos de ocupação missing) .
        if(tipo == "censo" & ano == 2010){
                banco[(v6461 == 0 | v6461 == 9629) & isic == 10 & trtot > 4  & PosicaoOcup == 1, egp11 := 8]
                banco[(v6461 == 0 | v6461 == 9629) & isic == 10 & trtot <= 4 & PosicaoOcup == 1, egp11 := 11]
                banco[(v6461 == 0 | v6461 == 9629) & isic == 10 & PosicaoOcup == 2, egp11 := 6]
                banco[(v6461 == 0 | v6461 == 9629) & isic == 10 & (PosicaoOcup == 0 |PosicaoOcup == 3), egp11 := 7]
                banco[(v6461 == 0 | v6461 == 9629) & isic != 10 &  PosicaoOcup == 2, egp11 := 5]
        }
        
        
        #1 'I. Higher professionals'
        #2 'II. Lower professionals'
        #3 'IIIa. Routine non-manuals, higher degree'
        #4 'IIIb. Routine non-manuals, lower degree'
        #5 'IVa2. Proprietors and employers'
        #6 'IVc1 - Rural employers'
        #7 'IVc2. Self-employed farmers and subsistence agriculture workers'
        #8 'V.  Technicians and Supervisors of manual workers'
        #9 'VI. Skilled workers'
        #10 'VIIa Semi-, and unskilled workers'
        #11 'VIIb Agricultural workers'.
        

        banco[egp11 == 0 , egp11 := NA]
        return(banco[, egp11])
        

}
